export interface ThoughtSummary {
  id: string;
  createdAt: Date;
  content?: string;        // Markdown content (new format)
  title?: string;          // Extracted title for sidebar display (new format)
  
  // Legacy format compatibility
  subject?: string;
  background?: string;
  hypothesis?: string;
  analysis?: string;
  decision?: string;
  development?: string;
  insights?: string;
  output?: string;
}

export interface ApiResponse<T> {
  success: boolean;
  data?: T;
  error?: string;
}

export function generateMarkdownText(summary: ThoughtSummary): string {
  const date = new Date(summary.createdAt).toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
  const title = summary.subject || summary.title || 'Untitled';
  
  // 8ã‚«ãƒ†ã‚´ãƒªå½¢å¼ã®Markdownç”Ÿæˆ
  let markdown = `# ${title} - ${date}\n\n`;
  
  if (summary.subject) {
    markdown += `## ğŸ¯ Subject\n${summary.subject}\n\n`;
  }
  if (summary.background) {
    markdown += `## ğŸ“‹ Background\n${summary.background}\n\n`;
  }
  if (summary.hypothesis) {
    markdown += `## ğŸ’­ Hypothesis\n${summary.hypothesis}\n\n`;
  }
  if (summary.analysis) {
    markdown += `## ğŸ” Analysis\n${summary.analysis}\n\n`;
  }
  if (summary.decision) {
    markdown += `## âœ… Decision\n${summary.decision}\n\n`;
  }
  if (summary.development) {
    markdown += `## ğŸš€ Development\n${summary.development}\n\n`;
  }
  if (summary.insights) {
    markdown += `## ğŸ’¡ Insights\n${summary.insights}\n\n`;
  }
  if (summary.output) {
    markdown += `## ğŸ“¤ Output\n${summary.output}\n\n`;
  }
  
  // å¤ã„å½¢å¼ã¨ã®äº’æ›æ€§
  if (summary.content && !summary.subject) {
    markdown += `${summary.content}\n\n`;
  }
  
  markdown += `---\n*Generated by Scribble*`;
  
  return markdown;
}

// Markdown content ã‹ã‚‰ title ã‚’æŠ½å‡ºã™ã‚‹é–¢æ•°
export function extractTitleFromMarkdown(content: string): string {
  const firstHeading = content.match(/^#\s+(.+)$/m);
  if (firstHeading) {
    return firstHeading[1].trim();
  }
  
  const subjectMatch = content.match(/##\s+Subject\s*\n([^\n]+)/i);
  if (subjectMatch) {
    return subjectMatch[1].trim();
  }
  
  return 'Untitled Summary';
}